(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ac5d37dc"],{"089c":function(e,t,r){"use strict";var a=r("cf1c"),o=r("e524"),i=r("edc9"),n=r("5d8b"),l=r("d15c"),s=r("affb"),c=Math.max,d=Math.min,m=Math.floor,u=/\$([$&`']|\d\d?|<[^>]*>)/g,f=/\$([$&`']|\d\d?)/g,p=function(e){return void 0===e?e:String(e)};r("6432")("replace",2,(function(e,t,r,g){return[function(a,o){var i=e(this),n=void 0==a?void 0:a[t];return void 0!==n?n.call(a,i,o):r.call(String(i),a,o)},function(e,t){var o=g(r,e,this,t);if(o.done)return o.value;var m=a(e),u=String(this),f="function"===typeof t;f||(t=String(t));var v=m.global;if(v){var b=m.unicode;m.lastIndex=0}var x=[];while(1){var w=s(m,u);if(null===w)break;if(x.push(w),!v)break;var y=String(w[0]);""===y&&(m.lastIndex=l(u,i(m.lastIndex),b))}for(var k="",I=0,$=0;$<x.length;$++){w=x[$];for(var O=String(w[0]),M=c(d(n(w.index),u.length),0),S=[],j=1;j<w.length;j++)S.push(p(w[j]));var E=w.groups;if(f){var P=[O].concat(S,M,u);void 0!==E&&P.push(E);var C=String(t.apply(void 0,P))}else C=h(O,u,M,S,E,t);M>=I&&(k+=u.slice(I,M)+C,I=M+O.length)}return k+u.slice(I)}];function h(e,t,a,i,n,l){var s=a+e.length,c=i.length,d=f;return void 0!==n&&(n=o(n),d=u),r.call(l,d,(function(r,o){var l;switch(o.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,a);case"'":return t.slice(s);case"<":l=n[o.slice(1,-1)];break;default:var d=+o;if(0===d)return r;if(d>c){var u=m(d/10);return 0===u?r:u<=c?void 0===i[u-1]?o.charAt(1):i[u-1]+o.charAt(1):r}l=i[d-1]}return void 0===l?"":l}))}}))},"306f":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("a-row",{staticClass:"h-screen",attrs:{align:"middle",justify:"center",type:"flex"}},[r("a-col",{attrs:{lg:16,md:20,sm:20,xl:12,xs:23,xxl:8}},[r("div",{staticClass:"card-container animated fadeIn"},[r("a-card",{staticStyle:{"box-shadow":"rgba(99, 99, 99, 0.2) 0 2px 8px 0"},attrs:{bordered:!1}},[r("div",{staticClass:"halo-logo"},[r("span",[e._v("Halo "),r("small",[e._v("安装向导")])])]),r("a-alert",{attrs:{message:"欢迎使用 Halo，您正在安装的是 Halo "+e.VERSION+"。","show-icon":"",type:"success"}}),r("div",{staticClass:"mt-5 mb-5"},[r("a-radio-group",{model:{value:e.installationMode,callback:function(t){e.installationMode=t},expression:"installationMode"}},[r("a-radio-button",{attrs:{value:"new"}},[e._v(" 全新安装 ")]),r("a-radio-button",{attrs:{value:"import"}},[e._v(" 数据导入 ")])],1)],1),r("a-form-model",{directives:[{name:"show",rawName:"v-show",value:e.isInstallMode,expression:"isInstallMode"}],ref:"installationForm",staticClass:"installationForm animated fadeIn",attrs:{model:e.form.model,rules:e.form.rules,layout:"horizontal"}},[r("a-divider",{attrs:{dashed:"",orientation:"left"}},[e._v(" 管理员信息 ")]),r("a-form-model-item",{attrs:{prop:"username"}},[r("a-input",{attrs:{placeholder:"用户名"},model:{value:e.form.model.username,callback:function(t){e.$set(e.form.model,"username",t)},expression:"form.model.username"}},[r("a-icon",{staticStyle:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"user"},slot:"prefix"})],1)],1),r("a-form-model-item",{attrs:{prop:"username"}},[r("a-input",{attrs:{placeholder:"用户昵称"},model:{value:e.form.model.nickname,callback:function(t){e.$set(e.form.model,"nickname",t)},expression:"form.model.nickname"}},[r("a-icon",{staticStyle:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"user"},slot:"prefix"})],1)],1),r("a-form-model-item",{attrs:{prop:"email"}},[r("a-input",{attrs:{placeholder:"用户邮箱"},model:{value:e.form.model.email,callback:function(t){e.$set(e.form.model,"email",t)},expression:"form.model.email"}},[r("a-icon",{staticStyle:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"mail"},slot:"prefix"})],1)],1),r("a-form-model-item",{attrs:{prop:"password"}},[r("a-input",{attrs:{placeholder:"登录密码（8-100位）",type:"password"},model:{value:e.form.model.password,callback:function(t){e.$set(e.form.model,"password",t)},expression:"form.model.password"}},[r("a-icon",{staticStyle:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"lock"},slot:"prefix"})],1)],1),r("a-form-model-item",{attrs:{prop:"confirmPassword"}},[r("a-input",{attrs:{placeholder:"确认登录密码",type:"password"},model:{value:e.form.model.confirmPassword,callback:function(t){e.$set(e.form.model,"confirmPassword",t)},expression:"form.model.confirmPassword"}},[r("a-icon",{staticStyle:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"lock"},slot:"prefix"})],1)],1),r("a-divider",{attrs:{dashed:"",orientation:"left"}},[e._v(" 站点信息 ")]),r("a-form-model-item",{attrs:{prop:"url"}},[r("a-input",{attrs:{placeholder:"博客地址"},model:{value:e.form.model.url,callback:function(t){e.$set(e.form.model,"url",t)},expression:"form.model.url"}},[r("a-icon",{staticStyle:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"link"},slot:"prefix"})],1)],1),r("a-form-model-item",{attrs:{prop:"title"}},[r("a-input",{attrs:{placeholder:"博客标题"},model:{value:e.form.model.title,callback:function(t){e.$set(e.form.model,"title",t)},expression:"form.model.title"}},[r("a-icon",{staticStyle:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"book"},slot:"prefix"})],1)],1)],1),r("div",{directives:[{name:"show",rawName:"v-show",value:e.isImportMode,expression:"isImportMode"}],staticClass:"animated fadeIn"},[r("FilePondUpload",{ref:"upload",attrs:{accepts:["application/json"],multiple:!1,uploadHandler:e.onImportUpload,label:"拖拽或点击选择数据文件<br>请确认是否为 Halo 后台导出的文件。",name:"file"}})],1),r("div",{staticClass:"mt-8"},[e.isInstallMode?r("ReactiveButton",{attrs:{errored:e.form.installErrored,loading:e.form.installing,block:"",erroredText:"安装失败",icon:"check",loadedText:"安装成功",size:"large",text:"安装",type:"primary"},on:{callback:e.handleInstallCallback,click:e.handleInstall}}):e._e(),e.isImportMode?r("ReactiveButton",{attrs:{errored:e.form.importErrored,loading:e.form.importing,block:"",erroredText:"导入失败",icon:"import",loadedText:"导入成功",size:"large",text:"导入",type:"primary"},on:{callback:e.handleImportCallback,click:e.handleImport}}):e._e()],1)],1)],1)])],1)],1)},o=[],i=(r("0d1f"),r("f830"),r("ae8f"),r("089c"),r("dd51"),r("9d84")),n=r("9a0b"),l=r("3ed1"),s=r("bbf5");function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){Object(n["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var m={data:function(){var e=this,t=function(t,r,a){r!==e.form.model.password?a(new Error("确认密码与所输入的密码不一致")):a()};return{installationMode:"new",form:{model:{},rules:{username:[{required:!0,message:"* 用户名不能为空",trigger:["change"]},{max:50,message:"* 用户名的字符长度不能超过 50",trigger:["change"]}],nickname:[{required:!0,message:"* 用户昵称不能为空",trigger:["change"]},{max:255,message:"* 用户昵称的字符长度不能超过 255",trigger:["change"]}],email:[{required:!0,message:"* 电子邮件地址不能为空",trigger:["change"]},{max:127,message:"* 电子邮件地址的字符长度不能超过 127",trigger:["change"]},{pattern:/\w[-\w.+]*@([A-Za-z0-9][-A-Za-z0-9]+\.)+[A-Za-z]{2,14}/g,message:"* 电子邮件地址的格式不正确",trigger:["change"]}],password:[{required:!0,message:"* 密码不能为空",trigger:["change"]},{min:8,max:100,message:"* 密码的字符长度必须在 8 - 100 之间",trigger:["change"]}],confirmPassword:[{required:!0,message:"* 确认密码不能为空",trigger:["change"]},{validator:t,trigger:["change"]}],url:[{required:!0,message:"* 博客地址不能为空",trigger:["change"]}],title:[{required:!0,message:"* 博客标题不能为空",trigger:["change"]}]},installing:!1,installErrored:!1,importing:!1,importErrored:!1,importData:null}}},beforeMount:function(){this.handleVerifyIsInstall(),this.$set(this.form.model,"url",window.location.protocol+"//"+window.location.host)},computed:{isInstallMode:function(){return"new"===this.installationMode},isImportMode:function(){return"import"===this.installationMode}},methods:d(d({},Object(s["b"])(["installCleanToken"])),{},{handleVerifyIsInstall:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,l["a"].isInstalled();case 2:if(t=e.sent,!t.data){e.next=6;break}return e.next=6,this.$router.push({name:"Login"});case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),handleInstall:function(){var e=this;this.$refs.installationForm.validate((function(t){t&&(e.form.installing=!0,e.installCleanToken(e.form.model).then((function(t){e.$log.debug("Installation response",t)})).catch((function(){e.form.installErrored=!0})).finally((function(){setTimeout((function(){e.form.installing=!1}),400)})))}))},handleInstallCallback:function(){this.form.installErrored?this.form.installErrored=!1:(this.$message.success("安装成功！"),this.$router.push({name:"Login"}))},onImportUpload:function(e){var t=this;return this.$log.debug("Selected data",e),this.form.importData=e,new Promise((function(e){t.$log.debug("Handle uploading"),e()}))},handleImport:function(){var e=this;this.form.importData?(this.form.importing=!0,l["a"].migration.migrate(this.form.importData).then((function(){e.$log.debug("Migrated successfully")})).catch((function(){e.form.importErrored=!0})).finally((function(){setTimeout((function(){e.form.importing=!1}),400)}))):this.$message.warning("请先上传数据文件！")},handleImportCallback:function(){this.form.importErrored?this.form.importErrored=!1:(this.$message.success("导入成功！"),this.$router.replace({name:"Login"}))}})},u=m,f=(r("6d6e"),r("838c")),p=Object(f["a"])(u,a,o,!1,null,"8af64022",null);t["default"]=p.exports},"6d6e":function(e,t,r){"use strict";r("b2d2")},b2d2:function(e,t,r){}}]);